(function(d){var e={},a={},f="";var c={api_key:"",host:"http://pumpic.com/currency.html",currBase:"USD",currCode:{usd:"$",eur:"€",gbp:"£"},filter:{iso:["USD","EUR","GBP"]},rates:{},convert:{from:false,to:false},ajax:{dataType:"json",type:"POST",crossDomain:true,data:{}},onOpen:false};var b={init:function(g){b._die("Load init! *Curr");e=d(this);b.setSettings(g);b.setRates();b._die("Rates ...");b._die(c.rates);b._initMoney();b.triggerCall(c.onOpen);return d(this)},setSettings:function(g){if(typeof g!=="undefined"){c=d.extend(c,g||{})}},setRates:function(g){if(typeof g!=="undefined"){c.rates=g}else{if(a=b._json()){c.rates=a}}},triggerCall:function(h,g){d.isFunction(h)&&h.call(this,g)},_die:function(g){console.log(g)},_clearCookie:function(g){if(d.cookie(g)){d.removeCookie(g,{path:"/"})}},setCookie:function(g,h){d.cookie(g,h,{expires:7,path:"/"})},getCookie:function(g){if(d.cookie(g)){return d.cookie(g)}else{return false}},_clearCach:function(g){if(g){jQuery.data(window,g,false)}else{jQuery.data(window,"_result",false)}},setCach:function(g,h){g=(!g)?"_result":g;if(h){return jQuery.data(window,g,h)}else{return jQuery.data(window,g)}},getCach:function(g){if(jQuery.data(window,g)){return jQuery.data(window,g)}else{return false}},_json:function(i){b._die("Load json curr..");var h="";i=(i)?i:{_base:c.currBase,_filter:c.filter};var g={};d.ajax({type:c.ajax.type,async:false,url:c.host,data:d.extend(i,c.ajax.data),dataType:c.ajax.dataType,crossDomain:c.ajax.crossDomain}).done(function(j){if(j){b.setCach("_ajax",j)}});return g=b.getCach("_ajax")},_initMoney:function(g){var h={};if(c.rates){d.each(c.rates,function(i,j){if(j.iso){h[j.iso.toUpperCase()]=parseFloat(j.rates)}})}b._die(h);fx.rates=(h)?h:g.rates;fx.base=(c.currBase)?c.currBase:g.base},_convert:function(g,j,i){if(!g){return null}var h={from:(j)?j.toUpperCase():false,to:(i)?i.toUpperCase():false};return fx.convert(g,h)},bindEvent:function(){if(e.find(".store-flags").length){e.find(".store-flags").on("click",function(h){h.preventDefault();var g=d(this).attr("attr-rates-iso");if(b.getCach("currISO")){if(b.getCach("currISO")!=g){b.setCach("currISO",g)}}else{b.setCach("currISO",g)}e.find(".store-flags").each(function(){if(d(this).hasClass("active")){d(this).removeClass("active")}});d(this).addClass("active");b.afterEvent();return false})}},unbindEvent:function(){e.find(".store-flags").off("click")},show:function(){var g=[];if(c.rates){f+='<ul class="clearfix">';d.each(c.rates,function(h,i){g[h]=(i.iso.toUpperCase()==c.currBase)?"active":"";f+='<li><span class="store-flags flag-'+i.iso+" "+g[h]+'" attr-rates-iso="'+i.iso+'" attr-rates-id="'+i.id+'"></span></li>'});f+="</ul>";e.html(f);b.beforeEvent();b.bindEvent()}},beforeEvent:function(){d(".box-currence").each(function(){var g=d(this).find("symbol"),h=g.attr("attr-iso");if(!h){g.attr("attr-iso",c.currBase)}if(!g.text()){g.text(c.currCode[c.currBase.toLowerCase()])}})},afterEvent:function(){d(".box-currence").each(function(){var g=d(this).find("symbol"),h=d(this).find("curr"),k=g.text(),j=h.text(),i=g.attr("attr-iso");if(j){h.html(b._convert(parseFloat(j),i,b.getCach("currISO")||c.currBase).toFixed(2));g.attr("attr-iso",b.getCach("currISO"));g.text(c.currCode[b.getCach("currISO").toLowerCase()])}})},run:function(g){b._die(g);b._die("Rates init");b._die(c.rates)}};d.fn.currancy=function(h,g){if(b[h]){return b[h].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof h==="object"||!h){b.init.apply(this,arguments);if(typeof g!=="undefined"&&b[g]){return b[g].apply(this,Array.prototype.slice.call(arguments,1))}}else{d.error("Метод с именем "+h+" не существует для jQuery.tooltip")}}}})(jQuery);$(document).ready(function(){if($(".list-currencies").length){$(".list-currencies").currancy({onOpen:function(){}},"show")}});